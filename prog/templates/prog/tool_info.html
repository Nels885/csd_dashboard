{% extends 'format/detail_format.html' %}

{% load static i18n %}

{% block detail_content %}

    <table class="table table-striped table-sm" style="width: 100%;">
        <tbody>

            {% for obj in object_list %}
            <tr>
                <td class="col-3 font-weight-bold">
                    {{ obj.name }}
                </td>
                <td class="col-6">
                    {% with obj.url|add:obj.status_path as url %}
                        <a href="{{ url }}" target="_blank">{{ url }}</a>
                    {% endwith %}
                </td>
                <td class="col-3 font-weight-bold">
                    STATUS :<span id="{{ obj.name|slugify }}" class="ml-4"></span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}

{% block extrascripts %}

    <script type="text/javascript">
        const slugify = str =>
          str
            .toLowerCase()
            .trim()
            .replace(/[^\w\s-]/g, '')
            .replace(/[\s_-]+/g, '-')
            .replace(/^-+|-+$/g, '');

        function get_tool_info() {
            $.ajax({
                method: "get",
                url: "{% url 'prog:ajax_tool_info' %}",
                success: function(data) {
                    console.log(data);
                    for (var key in data) {
                        $('#' + slugify(key)).html(data[key]);
                    }
                },
                error: function(error) {
                    console.log(error);
                }
            })
        }

        get_tool_info();
        setInterval(get_tool_info, 5000);
    </script>

{% endblock %}